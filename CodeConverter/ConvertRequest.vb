' Licensed to the .NET Foundation under one or more agreements.
' The .NET Foundation licenses this file to you under the MIT license.
' See the LICENSE file in the project root for more information.
Option Explicit On
Option Infer Off
Option Strict On

#If NETCOREAPP3_0 Then
Imports ManageProgressBar
#Else

Imports ReportProgress = System.Object

#End If

Public Class ConvertRequest
    Public Const CS_To_VB As String = "cs2vb"
    Public Const VB_To_CS As String = "vb2CS"
    Private _progressBar As ReportProgress

    Sub New(_RequestedConversion As String, _SkipAutoGenerated As Boolean, _DoEvents As DoEvents, _ProgressBar As ReportProgress)
        MyDoEvents = _DoEvents
        ProgressBar = _ProgressBar
        RequestedConversion = _RequestedConversion
        SkipAutoGenerated = _SkipAutoGenerated
    End Sub

    Public Delegate Sub DoEvents()

    Private ReadOnly Property RequestedConversion As String
    Public ReadOnly Property MyDoEvents As DoEvents
    Public ReadOnly Property SkipAutoGenerated As Boolean
    Public Property SourceCode As String

    Public Property ProgressBar As ReportProgress
        Get
            Return _progressBar
        End Get
        Set(value As ReportProgress)
            _progressBar = value
        End Set
    End Property

    Public Function GetSourceExtension() As String
        Return RequestedConversion.ToString(Globalization.CultureInfo.InvariantCulture).Left(2)
    End Function

    Public Function GetTargetExtension() As String
        Return RequestedConversion.ToString(Globalization.CultureInfo.InvariantCulture).Right(2)
    End Function

End Class
